<mxfile host="app.diagrams.net" modified="2024-12-10T05:24:00.000Z" agent="DrawioClient" version="24.0.0">
  <diagram name="Part 2 - Script Generation" id="part2">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title2" value="PART 2: SCRIPT GENERATION FLOW" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="300" y="40" width="600" height="40" as="geometry" />
        </mxCell>
        
        <!-- Start -->
        <mxCell id="start2" value="START&#xa;Product Bible + User Requirement" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="480" y="120" width="240" height="60" as="geometry" />
        </mxCell>
        
        <!-- MODULE 2.2: IntentRouter -->
        <mxCell id="module2_2_title" value="MODULE 2.2: Intent Router" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="220" width="400" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="start2" target="module2_2_title">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 1: Build Classification Prompt -->
        <mxCell id="step2_1" value="1. Build Classification Prompt&#xa;User requirement + Product name&#xa;+ Intent examples" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="500" y="300" width="200" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="module2_2_title" target="step2_1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- MODULE 2.1: Gemini Client Call -->
        <mxCell id="step2_2" value="2. Gemini API Call&#xa;generate_structured()&#xa;Schema: IntentClassification" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="410" width="200" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="step2_1" target="step2_2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Decision: API Success? -->
        <mxCell id="decision2_1" value="API Call&#xa;Success?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="540" y="520" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="step2_2" target="decision2_1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Fallback: Keyword Matching -->
        <mxCell id="fallback2_1" value="FALLBACK&#xa;Keyword Matching&#xa;unboxâ†’motion&#xa;ngÃ yâ†’montage" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="780" y="525" width="140" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_5" value="NO" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=11;fontStyle=1" edge="1" parent="1" source="decision2_1" target="fallback2_1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Intent Result -->
        <mxCell id="intent_result" value="Intent Classification&#xa;{intent, confidence, rationale}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="650" width="200" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_6" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=11;fontStyle=1" edge="1" parent="1" source="decision2_1" target="intent_result">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="fallback2_1" target="intent_result">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="680" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Branch: Select Template -->
        <mxCell id="branch_title" value="Select Template Based on Intent" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="760" width="400" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3" edge="1" parent="1" source="intent_result" target="branch_title">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Templates -->
        <mxCell id="template_narrative" value="NARRATIVE Template&#xa;Hook (3s)&#xa;Body (15s) - Features&#xa;CTA (3s)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="240" y="850" width="160" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="template_motion" value="MOTION Template&#xa;Fast cuts&#xa;Camera movements&#xa;Action-driven" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="460" y="850" width="160" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="template_montage" value="MONTAGE Template&#xa;5-7 short clips (3-4s)&#xa;Emotional arc&#xa;Music-driven" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="680" y="850" width="160" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_9" value="narrative" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10" edge="1" parent="1" source="branch_title" target="template_narrative">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_10" value="motion" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10" edge="1" parent="1" source="branch_title" target="template_motion">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_11" value="montage" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=10" edge="1" parent="1" source="branch_title" target="template_montage">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- MODULE 2.3: Screenwriter -->
        <mxCell id="module2_3_title" value="MODULE 2.3: Screenwriter" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="990" width="400" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="template_narrative" target="module2_3_title">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="320" y="970" />
              <mxPoint x="520" y="970" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow2_13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="template_motion" target="module2_3_title">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="540" y="970" />
              <mxPoint x="600" y="970" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="arrow2_14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="template_montage" target="module2_3_title">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="760" y="970" />
              <mxPoint x="680" y="970" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Step 3: Format Product Info -->
        <mxCell id="step2_3" value="3. Format Product Info&#xa;Extract from Product Bible&#xa;Brand, Color, Features" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="500" y="1070" width="200" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="module2_3_title" target="step2_3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 4: Build Final Prompt -->
        <mxCell id="step2_4" value="4. Build Final Prompt&#xa;Template + Product Info&#xa;+ User Requirement" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="500" y="1180" width="200" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="step2_3" target="step2_4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 5: Gemini Generate Script -->
        <mxCell id="step2_5" value="5. Gemini API Call&#xa;generate_structured()&#xa;Schema: VideoScript" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="1290" width="200" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2" edge="1" parent="1" source="step2_4" target="step2_5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Output -->
        <mxCell id="output2" value="OUTPUT&#xa;VideoScript&#xa;{hook, body, cta, scenes[]}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="480" y="1410" width="240" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2_18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=3" edge="1" parent="1" source="step2_5" target="output2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Scene Breakdown Box -->
        <mxCell id="scene_box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2" vertex="1" parent="1">
          <mxGeometry x="800" y="1280" width="280" height="210" as="geometry" />
        </mxCell>
        
        <mxCell id="scene_title" value="SCENE STRUCTURE" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="820" y="1290" width="240" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="scene_content" value="Each Scene Contains:&#xa;â€¢ scene_id: int&#xa;â€¢ duration: int (max 8s)&#xa;â€¢ visual_prompt: str&#xa;  â†’ For video AI generation&#xa;â€¢ narration: str&#xa;  â†’ For TTS&#xa;â€¢ product_features_shown: []&#xa;  â†’ For consistency tracking" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="820" y="1330" width="240" height="150" as="geometry" />
        </mxCell>
        
        <!-- Stats Box -->
        <mxCell id="stats2_box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2" vertex="1" parent="1">
          <mxGeometry x="80" y="1280" width="280" height="210" as="geometry" />
        </mxCell>
        
        <mxCell id="stats2_title" value="PART 2 STATISTICS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="1290" width="240" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="stats2_content" value="â±ï¸ Processing Time: 3-10s&#xa;ðŸ’° Cost: $0.003/script (Gemini)&#xa;ðŸŽ¯ Intent Accuracy: ~85-90%&#xa;ðŸ“ Script Length: 21-24s&#xa;ðŸŽ¬ Scenes Generated: 3-5&#xa;âœ… Success Rate: ~95%&#xa;ðŸ”„ Retry w/ Backoff: 3 attempts" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="100" y="1330" width="240" height="150" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
